# -*- coding: utf-8 -*-
"""linear boston.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1cxBwk8hq4R_mKPj60ArbCVe01dyKoLiE

Learning Linear Regression from scratch from the Boston dataset.  Code adopted from: 

https://github.com/prateeksharma51/Multivariate-Linear-Regression-from-scratch-in-python/blob/master/Multivariate_Linear_Regression_from_Scratch.ipynb
"""

from sklearn.datasets import load_boston
import matplotlib.pyplot as plt 
from sklearn import preprocessing
import numpy as np
boston = load_boston()
from sklearn.linear_model import LinearRegression

print(boston.DESCR)

"""Print just a bit of the dataset to get a feeling..."""

print("Shape of Dataset : ", boston.data.shape)
print("Feature names : ", boston.feature_names)
print("Target Values : ", boston.target[:20])

"""Split the data into the X (dependent variable) and Y (independent variable / target). 

See https://en.wikipedia.org/wiki/Dependent_and_independent_variables for more if you like.
"""

import pandas as pd
X = pd.DataFrame(boston.data, columns = boston.feature_names)
Y = boston.target   
print(X.head())
print(Y)

"""Now let's split the data into training and testing. Note that no cross validation is done here."""

from sklearn.model_selection import train_test_split
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.33, random_state = 5)
print(X_train.shape)
print(X_test.shape)
print(Y_train.shape)
print(Y_test.shape)
#print(X_train.head(2))                                          
#print(X_test.head(2))
print(Y_train)

"""Let's standardize the data. There are two ways: The built-in way (which we'll use) and from scratch."""

scaler = preprocessing.StandardScaler()
# Fit your data on the scaler object
X_train_standardized = scaler.fit_transform(X_train)
X_test_standardized = scaler.fit_transform(X_test)
#X_train_standardized = (X_train - X_train .mean()) / X_train.std()
#X_test_standardized  = (X_test - X_train.mean()) /  X_train.std()

"""Let's setup the variable for the cost function from gradient descent.  We'll cap the number of iterations at 300 and the set the learning rate to 0.05 (completely open to change). We'll store the error values in a variable called MSE (and we'll define the error function very soon)."""

MSE_points = []
num_iterations = 300
learning_rate = 0.05

"""Now it's time for gradient descent. First, we'll define our cost function:


![image.png](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbsAAAB6CAYAAAAmqv27AAAgAElEQVR4Ae2dCfwVVfn/LU0iRKxMDdQsUDRcMhWCUlIDUczUUEMBCVMxFAUXsIwwFktJkczcytIwlURzw6VwaVOCUBMFUTJBCgMVCkHDzu/1Pv//M50739nvzL1z733O63VfM3fmzFk+c+Y851nPZkaTIqAIKAKKgCLQ5Ahs1uT90+4pAoqAIqAIKAJGiZ0OAkVAEVAEFIGmR0CJXdO/Yu2gIqAIKAKKgBI7HQOKgCKgCCgCTY+AErumf8XawTIhsH79erNq1SrzzjvvtGnWmjVrzMaNG9tc1wuKgCJQPQJK7KrHUEtQBGIRgMBdeuml5rjjjjN9+vQxZ599tnnjjTfsc3PmzDFjxowxffv2NSNHjjTLly+PLU8zKAKKQDoElNilw0tzlwiBefPmmenTpxuIxbvvvluilrVtyrJly8x+++1nNttsM/t73/veZ6666ipz8cUXm44dO3rXuT9p0qS2BegVRUARqAoBJXZVwacP1wMBiNzYsWNN586dLZEYMmSI+e9//1uPpqSqE8ImxI5jp06dzOGHH26J26677urdGzFiRKpyNbMioAjEI6DELh4jzVESBJYuXWrGjx9vunTp4hEGiMawYcNK0sLoZkycOLGi3T179jQLFy60Dw0aNMi7Rz5NioAikC8CSuzyxVNLKwABjDaefvppM2rUKNOhQwePKAiXhB7s7bffLqDm/IrcsGGDOeKII7y277bbbmbBggW2grfeessceeSR9l779u3NQw89lF/FWpIioAhYBJTY6UAoPQKLFy828+fPN88995yZOXOm2XHHHT2iAcHr1auXWb16dan78cILL5hu3brZdr/nPe8xLve2aNEi84lPfMLe69Gjh4GD1aQIKAL5IqDELl88tbQCEICzE53cpk2bzFFHHVVB7Pbaay+zYsWKAmrOr8if/exnZsstt7Tt3mWXXSzhltIh4FtssYW9d+aZZwa6JUhePSoCikA2BJTYZcNNn6ojAhMmTKggdvvuu69ZuXJlHVsUXTUuBv379/fafOyxx1aIXceNG2fvtWvXzsyePTu6ML2rCCgCmRBQYpcJNn2onghcd911HuFAjHnooYeaN998s55Niqz7+eefN9tvv71t8zbbbGNmzZrl5YdTPeGEE+y9rl27miVL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)
"""

def error_function(y_actual,y_predicted):
    error = 0
    for i in range(0,len(y_actual)):
        error =  error + pow((y_actual[i] - y_predicted[i]),2)#This is Y-YP
    return error/(2*len(y_actual))

"""Now for gradient descent itself: """

def gradient_descent(y_actual,y_pred,x):
    grad = np.zeros(x.shape[1])
    for i in range(x.shape[1]):
        for j in range(0,len(y_actual)):
            grad[i] = grad[i] + (y_pred[j] - y_actual[j])*x[j][i]
            #grad[i] = grad[i] - (y_actual[j]-y_pred[j])*x[j][i] #other way to write this
    return grad/len(y_actual)

"""This function will be called within a loop to set the weights. Note that the "b" term is added in the line: theta = np.append(theta,1) and that y_predicted will only be defined in the next code block."""

def weights(x_train,y_train,num_iterations,learning_rate):
    no_of_rows = x_train.shape[0]
    no_of_columns = x_train.shape[1]
    new_x_train = np.ones((no_of_rows,no_of_columns+1))
    new_x_train[:,0:no_of_columns] = x_train
    theta = np.zeros(no_of_columns)
    theta = np.append(theta,1)
    for i in range(0,num_iterations):
        y_pred = y_predicted(theta,new_x_train)
        error = error_function(y_train,y_pred)
        #print("mean square error: ",error,"after",i,"th iteration")
        MSE_points.append(error)
        grad = gradient_descent(y_train,y_pred,new_x_train)
        theta = theta - learning_rate*grad
    return theta

"""Now that we have our weights we can predict (use) the model with the weights, w (also called theta in our slides).  Note that this process uses two loops: One for weights to go through all values, and one for the gradient descent. In our lectures we'll talk about using vectorization to eliminate this and you'll get to do that too!"""

def y_predicted(theta,x):
    y_pred = np.zeros(len(x))
    for i in range(0,len(x)):
        for j in range(0,len(theta)-1):
            y_pred[i] = y_pred[i]+(theta[j]*x[i][j])#for the weights
        y_pred[i]+=theta[-1] #for the bias
    return y_pred

def regression_test(x_test,theta):
    row = x_test.shape[0]
    column = x_test.shape[1]
    new_x_test = np.ones((row,column+1))
    new_x_test[:,0:column] = x_test
    y_pred = y_predicted(theta,new_x_test)
    return(y_pred)

"""Now we call the above functions!"""

thetas = weights(X_train_standardized,Y_train,num_iterations,learning_rate)
Y_pred = regression_test(X_test_standardized,thetas)
error_function(Y_test,Y_pred)

plt.title('Cost Function J', size = 30)
plt.xlabel('No. of iterations', size=20)
plt.ylabel('Cost', size=20)
plt.plot(MSE_points)
plt.show()

"""How well did we do?  Well we can check it on the data:"""

pred_df = pd.DataFrame(
    {
        'Actual Value' : Y_test, 
     'Predicted Values' : Y_pred,
    }
)
print(pred_df.head(10))

"""We can also use the built-in MSE functions from scikit learn"""

from sklearn.metrics import mean_squared_error
MSE_custom_LR_Model = mean_squared_error(Y_test, Y_pred)
print('Linear Regression (From Scratch)', str(MSE_custom_LR_Model))

"""Ok, but how does this compare with the built-in implementation?  Not bad!  Let's see!"""

lm = LinearRegression()
lm.fit(X_train, Y_train)
y_pred_from_sklearn = lm.predict(X_test)
MSE_sklearn_LR_Model = mean_squared_error(Y_test, y_pred_from_sklearn)
print('Linear Regression (SKLEARN)', str(MSE_sklearn_LR_Model))

"""So just to summarize: """

print('Linear Regression (From Scratch)', str(MSE_custom_LR_Model))
print('Linear Regression (SKLEARN)', str(MSE_sklearn_LR_Model))

